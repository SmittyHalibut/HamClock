#include "HamClock.h"

typedef struct {
    char prefix[MAX_PREF_LEN];            // prefix, left justified, \0 padded but none if full
    int16_t lat, lng;                     // rough center, degs*100 +E +N
} Prefix;

static const Prefix prefixes[] PROGMEM = {
     {{'1','A','\0','\0'},        4154,   1230},
     {{'1','S','\0','\0'},         839,  11129},
     {{'3','A','\0','\0'},        4345,    725},
     {{'3','B','6','\0'},        -1021,   5636},
     {{'3','B','8','\0'},        -2010,   5730},
     {{'3','B','9','\0'},        -1941,   6328},
     {{'3','C','\0','\0'},         345,    847},
     {{'3','C','0','\0'},          128,    540},
     {{'3','D','2','\0'},        -1807,  17825},
     {{'3','D','2','c'},         -2144,  17438},
     {{'3','D','2','x'},         -1248,  17701},
     {{'3','D','A','\0'},        -2718,   3160},
     {{'3','V','\0','\0'},        3647,   1011},
     {{'3','W','\0','\0'},        1048,  10642},
     {{'3','X','\0','\0'},         931,  -1343},
     {{'3','Y','\0','\0'},       -5418,    322},
     {{'3','Y','0','\0'},        -6840,  -9040},
     {{'4','J','\0','\0'},        4036,   4989},
     {{'4','L','\0','\0'},        4143,   4449},
     {{'4','O','\0','\0'},        4244,   1926},
     {{'4','S','\0','\0'},         656,   7951},
     {{'4','U','1','i'},          4612,    609},
     {{'4','U','1','u'},          4043,  -7401},
     {{'4','W','\0','\0'},        -855,  12557},
     {{'4','X','\0','\0'},        3146,   3514},
     {{'5','A','\0','\0'},        3000,   1400},
     {{'5','A','\0','\0'},        3000,   2100},
     {{'5','A','\0','\0'},        2300,   2100},
     {{'5','A','\0','\0'},        2600,   1200},
     {{'5','B','\0','\0'},        3510,   3322},
     {{'5','H','\0','\0'},        -400,   3300},
     {{'5','H','\0','\0'},        -700,   3800},
     {{'5','N','\0','\0'},         627,    324},
     {{'5','R','\0','\0'},       -1700,   4600},
     {{'5','R','\0','\0'},       -2200,   4500},
     {{'5','T','\0','\0'},        2400,   -800},
     {{'5','T','\0','\0'},        1800,   -800},
     {{'5','T','\0','\0'},        1800,  -1500},
     {{'5','U','\0','\0'},        1900,   1100},
     {{'5','U','\0','\0'},        1500,    900},
     {{'5','U','\0','\0'},        1400,    200},
     {{'5','V','\0','\0'},         608,    112},
     {{'5','W','\0','\0'},       -1350, -17144},
     {{'5','X','\0','\0'},          19,   3125},
     {{'5','Z','\0','\0'},        -117,   3649},
     {{'6','W','\0','\0'},        1440,  -1726},
     {{'6','Y','\0','\0'},        1800,  -7648},
     {{'7','O','\0','\0'},        1500,   4700},
     {{'7','P','\0','\0'},       -2919,   2729},
     {{'7','Q','\0','\0'},       -1359,   3344},
     {{'7','X','\0','\0'},        3400,    300},
     {{'7','X','\0','\0'},        2300,    600},
     {{'7','X','\0','\0'},        2700,    400},
     {{'8','P','\0','\0'},        1306,  -5937},
     {{'8','Q','\0','\0'},         373,   7300},
     {{'8','R','\0','\0'},         648,  -5810},
     {{'9','A','\0','\0'},        4548,   1558},
     {{'9','G','\0','\0'},         533,    -13},
     {{'9','H','\0','\0'},        3554,   1431},
     {{'9','J','\0','\0'},       -1400,   2600},
     {{'9','J','\0','\0'},       -1000,   3100},
     {{'9','K','\0','\0'},        2920,   4759},
     {{'9','L','\0','\0'},         830,  -1315},
     {{'9','M','2','\0'},          310,  10142},
     {{'9','M','6','\0'},          601,  11607},
     {{'9','M','8','\0'},          200,  11300},
     {{'9','N','\0','\0'},        2743,   8519},
     {{'9','Q','\0','\0'},         200,   2700},
     {{'9','Q','\0','\0'},           0,   1900},
     {{'9','Q','\0','\0'},        -700,   2500},
     {{'9','U','\0','\0'},        -323,   2922},
     {{'9','V','\0','\0'},         117,  10351},
     {{'9','X','\0','\0'},        -157,   3004},
     {{'9','Y','\0','\0'},        1039,  -6131},
     {{'A','2','\0','\0'},       -2200,   2400},
     {{'A','3','\0','\0'},       -2110, -17515},
     {{'A','4','\0','\0'},        2337,   5835},
     {{'A','5','\0','\0'},        2728,   8939},
     {{'A','6','\0','\0'},        2428,   5422},
     {{'A','7','\0','\0'},        2517,   5132},
     {{'A','9','\0','\0'},        2613,   5035},
     {{'A','P','\0','\0'},        3100,   7100},
     {{'A','P','\0','\0'},        2700,   6700},
     {{'B','S','7','\0'},         1518,  11776},
     {{'B','V','\0','\0'},        2503,  12130},
     {{'B','V','9','P'},          2071,  11669},
     {{'B','Y','0','\0'},         2400,   8400},
     {{'B','Y','0','\0'},         3900,   8300},
     {{'B','Y','1','\0'},         3954,  11625},
     {{'B','Y','2','\0'},         4330,  12700},
     {{'B','Y','3','\0'},         3900,  10000},
     {{'B','Y','3','\0'},         4100,  11200},
     {{'B','Y','4','\0'},         3114,  12130},
     {{'B','Y','5','\0'},         2839,  11558},
     {{'B','Y','6','\0'},         3440,  11338},
     {{'B','Y','7','\0'},         2809,  11300},
     {{'B','Y','8','\0'},         3039,  10404},
     {{'B','Y','9','\0'},         3600,   9400},
     {{'C','2','\0','\0'},         -30,  16655},
     {{'C','3','\0','\0'},        4230,    131},
     {{'C','5','\0','\0'},        1328,  -1639},
     {{'C','6','\0','\0'},        2505,  -7720},
     {{'C','9','\0','\0'},       -1400,   3800},
     {{'C','9','\0','\0'},       -1500,   3300},
     {{'C','9','\0','\0'},       -2200,   3400},
     {{'C','E','0','\0'},        -2706, -10921},
     {{'C','E','0','x'},         -2504,  -8025},
     {{'C','E','0','z'},         -3326,  -7841},
     {{'C','E','1','\0'},        -2339,  -7023},
     {{'C','E','2','\0'},        -3304,  -7140},
     {{'C','E','3','\0'},        -3327,  -7040},
     {{'C','E','4','\0'},        -3636,  -7209},
     {{'C','E','5','\0'},        -3747,  -7245},
     {{'C','E','6','\0'},        -3845,  -7240},
     {{'C','E','7','\0'},        -4128,  -7300},
     {{'C','E','8','\0'},        -5310,  -7056},
     {{'C','E','9','\0'},        -8500,  -6700},
     {{'C','N','\0','\0'},        3300,    500},
     {{'C','N','\0','\0'},        2900,  -1000},
     {{'C','O','\0','\0'},        2308,  -8222},
     {{'C','P','1','\0'},        -1630,  -6809},
     {{'C','P','6','\0'},        -1748,  -6310},
     {{'C','T','\0','\0'},        3844,   -908},
     {{'C','T','3','\0'},         3240,  -1645},
     {{'C','U','\0','\0'},        3739,  -2534},
     {{'C','X','\0','\0'},       -3453,  -5611},
     {{'C','Y','0','\0'},         4402,  -6000},
     {{'C','Y','9','\0'},         4713,  -6008},
     {{'D','2','\0','\0'},       -1200,   1700},
     {{'D','4','\0','\0'},        1500,  -2351},
     {{'D','6','\0','\0'},       -1141,   4316},
     {{'D','L','\0','\0'},        5231,   1324},
     {{'D','U','\0','\0'},        1435,  12100},
     {{'E','3','\0','\0'},        1520,   3900},
     {{'E','4','\0','\0'},        3177,   3521},
     {{'E','5','\0','\0'},       -2123, -15977},
     {{'E','6','\0','\0'},       -1857, -17006},
     {{'E','7','\0','\0'},        4352,   1825},
     {{'E','A','\0','\0'},        4024,   -341},
     {{'E','A','6','\0'},         3934,    239},
     {{'E','A','8','\0'},         2806,  -1524},
     {{'E','A','9','\0'},         3519,   -258},
     {{'E','I','\0','\0'},        5320,   -615},
     {{'E','K','\0','\0'},        4011,   4434},
     {{'E','L','\0','\0'},         618,  -1047},
     {{'E','P','\0','\0'},        3500,   4800},
     {{'E','P','\0','\0'},        3000,   5700},
     {{'E','P','\0','\0'},        3500,   5700},
     {{'E','R','\0','\0'},        4700,   2850},
     {{'E','S','\0','\0'},        5922,   2448},
     {{'E','T','\0','\0'},        1200,   3900},
     {{'E','T','\0','\0'},         700,   4200},
     {{'E','T','\0','\0'},         700,   3600},
     {{'E','U','\0','\0'},        5354,   2734},
     {{'E','X','\0','\0'},        4254,   7436},
     {{'E','Y','\0','\0'},        3835,   6848},
     {{'E','Z','\0','\0'},        3757,   5823},
     {{'F','\0','\0','\0'},       4852,    220},
     {{'F','G','\0','\0'},        1610,  -6140},
     {{'F','H','\0','\0'},       -1247,   4517},
     {{'F','J','\0','\0'},        1791,  -6283},
     {{'F','K','\0','\0'},       -2216,  16627},
     {{'F','K','\0','\0'},       -1900,  15800},
     {{'F','M','\0','\0'},        1436,  -6105},
     {{'F','O','\0','\0'},       -1753, -14956},
     {{'F','O','a','\0'},        -2300, -15000},
     {{'F','O','c','\0'},         1010, -10850},
     {{'F','O','m','\0'},         -944, -13938},
     {{'F','P','\0','\0'},        4655,  -5610},
     {{'F','R','\0','\0'},       -2052,   5528},
     {{'F','S','\0','\0'},        1809,  -6300},
     {{'F','T','g','\0'},        -1131,   4718},
     {{'F','T','j','\0'},        -1821,   4136},
     {{'F','T','t','\0'},        -1557,   5421},
     {{'F','T','w','\0'},        -4630,   5200},
     {{'F','T','x','\0'},        -4912,   7000},
     {{'F','T','z','\0'},        -3731,   7730},
     {{'F','W','\0','\0'},       -1311, -17643},
     {{'F','Y','\0','\0'},         455,  -5220},
     {{'G','\0','\0','\0'},       5130,     10},
     {{'G','D','\0','\0'},        5460,   -428},
     {{'G','I','\0','\0'},        5435,   -555},
     {{'G','J','\0','\0'},        4912,   -237},
     {{'G','M','\0','\0'},        5557,   -313},
     {{'G','M','s','\0'},         6000,   -313},
     {{'G','U','\0','\0'},        4927,   -231},
     {{'G','W','\0','\0'},        5129,   -313},
     {{'H','4','\0','\0'},        -926,  15957},
     {{'H','4','0','\0'},        -1068,  16606},
     {{'H','A','\0','\0'},        4730,   1905},
     {{'H','B','\0','\0'},        4657,    726},
     {{'H','B','0','\0'},         4790,    932},
     {{'H','C','\0','\0'},         -13,  -7830},
     {{'H','C','8','\0'},          -36,  -9018},
     {{'H','H','\0','\0'},        1832,  -7220},
     {{'H','I','\0','\0'},        1828,  -6954},
     {{'H','K','\0','\0'},           0,  -7200},
     {{'H','K','\0','\0'},         400,  -7000},
     {{'H','K','\0','\0'},         700,  -7500},
     {{'H','K','0','\0'},         1232,  -8142},
     {{'H','K','0','m'},           409,  -8138},
     {{'H','L','\0','\0'},        3733,  12658},
     {{'H','P','\0','\0'},         858,  -7931},
     {{'H','R','\0','\0'},        1406,  -8713},
     {{'H','S','\0','\0'},        1800,   9900},
     {{'H','S','\0','\0'},        1500,  10200},
     {{'H','S','\0','\0'},        1100,  10000},
     {{'H','V','\0','\0'},        4154,   1229},
     {{'H','Z','\0','\0'},        2800,   4000},
     {{'H','Z','\0','\0'},        2400,   4800},
     {{'H','Z','\0','\0'},        2000,   4200},
     {{'I','0','\0','\0'},        4154,   1229},
     {{'I','1','\0','\0'},        4424,    856},
     {{'I','2','\0','\0'},        4528,    911},
     {{'I','3','\0','\0'},        4526,   1220},
     {{'I','4','\0','\0'},        4430,   1120},
     {{'I','5','\0','\0'},        4347,   1115},
     {{'I','6','\0','\0'},        4240,   1343},
     {{'I','7','\0','\0'},        4107,   1652},
     {{'I','8','\0','\0'},        4050,   1415},
     {{'I','A','5','\0'},         4245,   1015},
     {{'I','C','2','\0'},         4549,    906},
     {{'I','C','8','\0'},         4033,   1413},
     {{'I','G','9','\0'},         3515,   1230},
     {{'I','H','9','\0'},         3645,   1200},
     {{'I','J','7','\0'},         4000,   1714},
     {{'I','L','3','\0'},         4526,   1220},
     {{'I','N','3','\0'},         4604,   1108},
     {{'I','P','1','\0'},         4418,    827},
     {{'I','S','\0','\0'},        3920,    900},
     {{'I','T','\0','\0'},        3729,   1400},
     {{'I','V','3','\0'},         4539,   1347},
     {{'J','2','\0','\0'},        1136,   4309},
     {{'J','3','\0','\0'},        1203,  -6145},
     {{'J','5','\0','\0'},        1151,  -1535},
     {{'J','6','\0','\0'},        1401,  -6100},
     {{'J','7','\0','\0'},        1518,  -6124},
     {{'J','8','\0','\0'},        1309,  -6114},
     {{'J','A','0','\0'},         3754,  13903},
     {{'J','A','1','\0'},         3542,  13946},
     {{'J','A','2','\0'},         3458,  13822},
     {{'J','A','3','\0'},         3500,  13544},
     {{'J','A','4','\0'},         3439,  13355},
     {{'J','A','5','\0'},         3420,  13403},
     {{'J','A','6','\0'},         3300,  13100},
     {{'J','A','7','\0'},         3942,  14109},
     {{'J','A','8','\0'},         4330,  14300},
     {{'J','A','9','\0'},         3640,  13713},
     {{'J','D','1','\0'},         2430,  15358},
     {{'J','D','1','o'},          2648,  14219},
     {{'J','T','\0','\0'},        4700,   9700},
     {{'J','T','\0','\0'},        4600,  10900},
     {{'J','W','\0','\0'},        7440,   1807},
     {{'J','X','\0','\0'},        7111,   -800},
     {{'J','Y','\0','\0'},        3157,   3556},
     {{'K','0','\0','\0'},        3940,  -9700},
     {{'K','1','\0','\0'},        4220,  -7105},
     {{'K','2','\0','\0'},        4040,  -7350},
     {{'K','3','\0','\0'},        3854,  -7700},
     {{'K','4','\0','\0'},        3200,  -8400},
     {{'K','5','\0','\0'},        3017,  -9745},
     {{'K','6','\0','\0'},        4000, -12000},
     {{'K','6','\0','\0'},        3400, -11600},
     {{'K','7','\0','\0'},        4500, -11200},
     {{'K','7','\0','\0'},        3300, -10900},
     {{'K','8','\0','\0'},        3959,  -8303},
     {{'K','9','\0','\0'},        3945,  -8610},
     {{'K','G','4','\0'},         1955,  -7506},
     {{'K','H','0','\0'},         1512,  14544},
     {{'K','H','1','\0'},            8, -17628},
     {{'K','H','2','\0'},         1328,  14444},
     {{'K','H','3','\0'},         1619, -16833},
     {{'K','H','4','\0'},         2814, -17548},
     {{'K','H','5','\0'},          549, -16213},
     {{'K','H','6','\0'},         2118, -15751},
     {{'K','H','7','k'},          2825, -17820},
     {{'K','H','8','\0'},        -1416, -17042},
     {{'K','H','8','\0'},        -1150, -17108},
     {{'K','H','9','\0'},         1921,  16640},
     {{'K','L','7','\0'},         6110, -15000},
     {{'K','P','1','\0'},         1823,  -7458},
     {{'K','P','2','\0'},         1821,  -6456},
     {{'K','P','4','\0'},         1829,  -6608},
     {{'K','P','5','\0'},         1823,  -6729},
     {{'L','A','\0','\0'},        6100,    900},
     {{'L','A','\0','\0'},        6600,   1100},
     {{'L','A','\0','\0'},        7000,   2300},
     {{'L','U','\0','\0'},       -3400,  -5600},
     {{'L','U','\0','\0'},       -3200,  -6400},
     {{'L','U','\0','\0'},       -3800,  -6600},
     {{'L','U','\0','\0'},       -4600,  -6700},
     {{'L','U','\0','\0'},       -5400,  -6600},
     {{'L','X','\0','\0'},        4936,    609},
     {{'L','Y','\0','\0'},        5440,   2519},
     {{'L','Z','\0','\0'},        4241,   2319},
     {{'O','A','\0','\0'},        -400,  -7500},
     {{'O','A','\0','\0'},       -1000,  -7500},
     {{'O','A','\0','\0'},       -1300,  -7200},
     {{'O','D','\0','\0'},        3353,   3529},
     {{'O','E','\0','\0'},        4813,   1620},
     {{'O','H','9','\0'},         6200,   2200},
     {{'O','H','8','\0'},         6300,   2400},
     {{'O','H','\0','\0'},        6300,   2400},
     {{'O','H','0','\0'},         6010,   1955},
     {{'O','J','0','\0'},         6018,   1907},
     {{'O','K','\0','\0'},        5005,   1426},
     {{'O','M','\0','\0'},        4809,   1709},
     {{'O','N','\0','\0'},        5050,    420},
     {{'O','X','\0','\0'},        7400,  -4000},
     {{'O','Y','\0','\0'},        6200,   -642},
     {{'O','Z','\0','\0'},        5540,   1235},
     {{'P','2','\0','\0'},        -930,  14710},
     {{'P','4','\0','\0'},        1233,  -7006},
     {{'P','5','\0','\0'},        3901,  12545},
     {{'P','A','\0','\0'},        5220,    454},
     {{'P','J','2','\0'},         1206,  -6856},
     {{'P','J','4','\0'},         1220,  -6826},
     {{'P','J','5','\0'},         1748,   6297},
     {{'P','J','7','\0'},         1804,  -6301},
     {{'P','P','1','\0'},        -2019,  -4021},
     {{'P','P','2','\0'},        -1639,  -4916},
     {{'P','P','5','\0'},        -2735,  -4831},
     {{'P','P','6','\0'},        -1055,  -3704},
     {{'P','P','7','\0'},         -940,  -3543},
     {{'P','P','8','\0'},         -300,  -6300},
     {{'P','Q','8','\0'},            2,  -5103},
     {{'P','R','7','\0'},         -707,  -3452},
     {{'P','S','7','\0'},         -547,  -3513},
     {{'P','S','8','\0'},         -505,  -4249},
     {{'P','T','2','\0'},        -1547,  -4755},
     {{'P','T','7','\0'},         -343,  -3879},
     {{'P','T','8','\0'},         -958,  -6748},
     {{'P','T','9','\0'},        -2027,  -5437},
     {{'P','V','8','\0'},          250,  -6043},
     {{'P','W','8','\0'},         -846,  -6354},
     {{'P','Y','0','f'},           351,  -3225},
     {{'P','Y','0','s'},            56,  -2934},
     {{'P','Y','0','t'},         -2025,  -2924},
     {{'P','Y','1','\0'},        -2253,  -4317},
     {{'P','Y','2','\0'},        -2333,  -4639},
     {{'P','Y','3','\0'},        -3003,  -5110},
     {{'P','Y','4','\0'},        -1955,  -4356},
     {{'P','Y','5','\0'},        -2524,  -4916},
     {{'P','Y','6','\0'},        -1259,  -3831},
     {{'P','Y','7','\0'},         -802,  -3454},
     {{'P','Y','8','\0'},         -300,  -5300},
     {{'P','Y','9','\0'},        -1000,  -5900},
     {{'P','Z','\0','\0'},         552,  -5514},
     {{'R','0','A','\0'},         5601,   9250},
     {{'R','0','B','\0'},         6925,   8615},
     {{'R','0','C','\0'},         4827,  13506},
     {{'R','0','D','\0'},         4848,  13257},
     {{'R','0','H','\0'},         6417,  10015},
     {{'R','0','I','\0'},         5934,  15047},
     {{'R','0','J','\0'},         5017,  12732},
     {{'R','0','L','\0'},         4310,  13156},
     {{'R','0','O','\0'},         5150,  10737},
     {{'R','0','Q','\0'},         6900,  11200},
     {{'R','0','S','\0'},         5216,  10420},
     {{'R','0','S','\0'},         5250,  10500},
     {{'R','0','U','\0'},         5203,  11330},
     {{'R','0','W','\0'},         5343,   9126},
     {{'R','0','X','\0'},         5600,  15900},
     {{'R','0','Y','\0'},         5142,   9427},
     {{'R','0','Z','\0'},         5454,   6906},
     {{'R','1','C','\0'},         5955,   3015},
     {{'R','1','F','\0'},         8100,   5800},
     {{'R','1','M','\0'},         6030,   2860},
     {{'R','1','N','\0'},         6147,   3420},
     {{'R','1','O','\0'},         6450,   4040},
     {{'R','1','P','\0'},         6740,   5300},
     {{'R','1','Q','\0'},         5912,   3954},
     {{'R','1','T','\0'},         5831,   3117},
     {{'R','1','W','\0'},         5750,   2820},
     {{'R','1','Z','\0'},         6859,   3308},
     {{'R','2','f','\0'},         5443,   2030},
     {{'R','3','A','\0'},         5545,   3735},
     {{'R','3','E','\0'},         5259,   3604},
     {{'R','3','G','\0'},         5237,   3935},
     {{'R','3','I','\0'},         5652,   3554},
     {{'R','3','K','\0'},         5140,   3910},
     {{'R','3','L','\0'},         5447,   3203},
     {{'R','3','M','\0'},         5737,   3952},
     {{'R','3','N','\0'},         5746,   4054},
     {{'R','3','P','\0'},         5412,   3736},
     {{'R','3','R','\0'},         5243,   4125},
     {{'R','3','S','\0'},         5438,   3944},
     {{'R','3','T','\0'},         5620,   4400},
     {{'R','3','U','\0'},         5700,   4059},
     {{'R','3','V','\0'},         5610,   4025},
     {{'R','3','W','\0'},         5142,   3611},
     {{'R','3','X','\0'},         5431,   3615},
     {{'R','3','Z','\0'},         5036,   3635},
     {{'R','4','A','\0'},         4844,   4425},
     {{'R','4','C','\0'},         5134,   4602},
     {{'R','4','F','\0'},         5313,   4500},
     {{'R','4','H','\0'},         5300,   5145},
     {{'R','4','L','\0'},         5420,   4824},
     {{'R','4','N','\0'},         5405,   3420},
     {{'R','4','P','\0'},         5545,   4908},
     {{'R','4','S','\0'},         5638,   4752},
     {{'R','4','U','\0'},         5411,   4511},
     {{'R','4','W','\0'},         5651,   5314},
     {{'R','4','Y','\0'},         5609,   4715},
     {{'R','6','A','\0'},         4502,   3900},
     {{'R','6','E','\0'},         4414,   4204},
     {{'R','6','H','\0'},         4502,   4159},
     {{'R','6','I','\0'},         4410,   4650},
     {{'R','6','J','\0'},         4440,   4310},
     {{'R','6','L','\0'},         4714,   3942},
     {{'R','6','P','\0'},         4320,   4542},
     {{'R','6','Q','\0'},         4322,   4477},
     {{'R','6','U','\0'},         4621,   4803},
     {{'R','6','W','\0'},         4258,   4730},
     {{'R','6','X','\0'},         4329,   4337},
     {{'R','6','Y','\0'},         4435,   4007},
     {{'R','9','A','\0'},         5510,   6124},
     {{'R','9','D','\0'},         5651,   6036},
     {{'R','9','F','\0'},         5800,   5615},
     {{'R','9','H','\0'},         5630,   8458},
     {{'R','9','K','\0'},         6633,   6634},
     {{'R','9','L','\0'},         5709,   6531},
     {{'R','9','M','\0'},         5500,   7323},
     {{'R','9','O','\0'},         5502,   8255},
     {{'R','9','Q','\0'},         5526,   6518},
     {{'R','9','S','\0'},         5154,   5506},
     {{'R','9','U','\0'},         5520,   8605},
     {{'R','9','W','\0'},         5444,   5556},
     {{'R','9','X','\0'},         6140,   5046},
     {{'R','9','Y','\0'},         5322,   8345},
     {{'R','9','Z','\0'},         5146,   8600},
     {{'S','0','\0','\0'},        2600,  -1100},
     {{'S','0','\0','\0'},        2300,  -1500},
     {{'S','2','\0','\0'},        2343,   9025},
     {{'S','5','\0','\0'},        4603,   1431},
     {{'S','7','\0','\0'},         438,   5527},
     {{'S','9','\0','\0'},          20,    644},
     {{'S','M','\0','\0'},        5900,   1500},
     {{'S','M','1','\0'},         5700,   1800},
     {{'S','M','2','\0'},         6600,   1900},
     {{'S','M','3','\0'},         6300,   1600},
     {{'S','P','\0','\0'},        5215,   2100},
     {{'S','T','\0','\0'},        1900,   3500},
     {{'S','T','\0','\0'},        1800,   2700},
     {{'S','T','\0','\0'},        1300,   2900},
     {{'S','U','\0','\0'},        3000,   2900},
     {{'S','U','\0','\0'},        2400,   2800},
     {{'S','U','\0','\0'},        2400,   3300},
     {{'S','V','\0','\0'},        3759,   2343},
     {{'S','V','5','\0'},         3626,   2813},
     {{'S','V','9','\0'},         3520,   2509},
     {{'S','v','a','\0'},         4009,   2421},
     {{'T','2','\0','\0'},        -922,  17943},
     {{'T','3','0','\0'},          141,  17313},
     {{'T','3','1','\0'},         -505, -17043},
     {{'T','3','2','\0'},          350, -15916},
     {{'T','3','3','\0'},          -52, -16935},
     {{'T','5','\0','\0'},         200,   4520},
     {{'T','7','\0','\0'},        4355,   1228},
     {{'T','8','\0','\0'},         751,  13458},
     {{'T','A','1','\0'},         4101,   2858},
     {{'T','A','2','\0'},         3954,   3250},
     {{'T','F','\0','\0'},        6409,  -2151},
     {{'T','G','\0','\0'},        1438,  -9031},
     {{'T','I','\0','\0'},         956,  -8405},
     {{'T','I','9','\0'},          548,  -8700},
     {{'T','J','\0','\0'},         352,   1131},
     {{'T','K','\0','\0'},        4155,    844},
     {{'T','L','\0','\0'},         422,   1835},
     {{'T','N','\0','\0'},        -416,   1517},
     {{'T','R','\0','\0'},          23,    927},
     {{'T','T','\0','\0'},        1800,   1900},
     {{'T','T','\0','\0'},        1200,   1700},
     {{'T','U','\0','\0'},         519,   -401},
     {{'T','Y','\0','\0'},         629,    237},
     {{'T','Z','\0','\0'},        2100,   -300},
     {{'T','Z','\0','\0'},        1700,      0},
     {{'T','Z','\0','\0'},        1300,   -700},
     {{'U','K','\0','\0'},        4120,   6918},
     {{'U','N','\0','\0'},        4315,   7656},
     {{'U','R','\0','\0'},        5030,   3100},
     {{'V','2','\0','\0'},        1703,  -6148},
     {{'V','3','\0','\0'},        1714,  -8845},
     {{'V','4','\0','\0'},        1610,  -6140},
     {{'V','5','\0','\0'},       -2100,   1600},
     {{'V','6','\0','\0'},         742,  15055},
     {{'V','7','\0','\0'},         700,  17100},
     {{'V','8','\0','\0'},         455,  11455},
     {{'V','E','1','\0'},         4438,  -6335},
     {{'V','E','2','\0'},         4650,  -7115},
     {{'V','E','3','\0'},         4342,  -7925},
     {{'V','E','4','\0'},         4953,  -9710},
     {{'V','E','5','\0'},         5030, -10438},
     {{'V','E','6','\0'},         5334, -11325},
     {{'V','E','7','\0'},         4825, -12322},
     {{'V','E','8','\0'},         6230, -11429},
     {{'V','E','9','\0'},         4557,  -6640},
     {{'V','K','0','h'},         -5303,   7330},
     {{'V','K','0','m'},         -5437,  15900},
     {{'V','K','1','\0'},        -3518,  14908},
     {{'V','K','2','\0'},        -3100,  14800},
     {{'V','K','3','\0'},        -3745,  14458},
     {{'V','K','4','\0'},        -2300,  14300},
     {{'V','K','5','\0'},        -3000,  13400},
     {{'V','K','6','\0'},        -2500,  12200},
     {{'V','K','7','\0'},        -4254,  14718},
     {{'V','K','8','\0'},        -1800,  13200},
     {{'V','K','9','c'},         -1140,   9651},
     {{'V','K','9','l'},         -3133,  15905},
     {{'V','K','9','m'},         -1700,  15500},
     {{'V','K','9','n'},         -2852,  16756},
     {{'V','K','9','w'},         -1614,  15000},
     {{'V','K','9','x'},         -1030,  10540},
     {{'V','O','1','\0'},         4734,  -5241},
     {{'V','O','2','\0'},         5254,  -6650},
     {{'V','P','2','e'},          1814,  -6305},
     {{'V','P','2','m'},          1644,  -6214},
     {{'V','P','2','v'},          1826,  -6437},
     {{'V','P','5','\0'},         2128,  -7108},
     {{'V','P','6','\0'},        -2440, -12447},
     {{'V','P','8','f'},         -5145,  -5900},
     {{'V','P','8','g'},         -5406,  -3658},
     {{'V','P','8','h'},         -6255,  -6034},
     {{'V','P','8','o'},         -6058,  -4558},
     {{'V','P','8','s'},         -5741,  -2806},
     {{'V','P','9','\0'},         3211,  -6445},
     {{'V','Q','9','\0'},         -519,   7228},
     {{'V','R','\0','\0'},        2217,  11409},
     {{'V','R','6','\0'},        -2504, -13100},
     {{'V','U','\0','\0'},        2100,   7800},
     {{'V','U','\0','\0'},        2800,   7600},
     {{'V','U','\0','\0'},        2300,   8500},
     {{'V','U','4','\0'},         1143,   9244},
     {{'V','U','7','\0'},         1028,   7237},
     {{'V','Y','0','\0'},         7000,  -7400},
     {{'V','Y','1','\0'},         6041, -13508},
     {{'V','Y','2','\0'},         4614,  -6309},
     {{'X','E','1','\0'},         2300, -10300},
     {{'X','E','2','\0'},         2700, -10600},
     {{'X','E','3','\0'},         1700,  -9800},
     {{'X','E','3','\0'},         2000,  -8900},
     {{'X','F','4','\0'},         1900, -11100},
     {{'X','T','\0','\0'},        1222,   -131},
     {{'X','U','\0','\0'},        1133,  10455},
     {{'X','W','\0','\0'},        1757,  10236},
     {{'X','X','9','\0'},         2214,  11335},
     {{'X','Z','\0','\0'},        1647,   9610},
     {{'Y','A','\0','\0'},        3400,   6600},
     {{'Y','B','0','\0'},         -608,  10645},
     {{'Y','B','1','\0'},         -657,  10734},
     {{'Y','B','2','\0'},         -658,  11029},
     {{'Y','B','3','\0'},         -714,  11245},
     {{'Y','B','4','\0'},         -259,  10445},
     {{'Y','B','5','\0'},         -100,  10021},
     {{'Y','B','6','\0'},          335,   9839},
     {{'Y','B','7','\0'},           -5,  10916},
     {{'Y','B','8','\0'},         -507,  11924},
     {{'Y','B','9','\0'},         -840,  11514},
     {{'Y','I','\0','\0'},        3300,   4300},
     {{'Y','J','\0','\0'},       -1744,  16819},
     {{'Y','K','\0','\0'},        3329,   3618},
     {{'Y','L','\0','\0'},        5700,   2400},
     {{'Y','N','\0','\0'},        1209,  -8617},
     {{'Y','O','\0','\0'},        4426,   2606},
     {{'Y','S','\0','\0'},        1341,  -8917},
     {{'Y','U','\0','\0'},        4455,   2030},
     {{'Y','V','\0','\0'},         300,  -6500},
     {{'Y','V','\0','\0'},         700,  -6300},
     {{'Y','V','\0','\0'},         900,  -7000},
     {{'Y','V','0','\0'},         1542,  -6338},
     {{'Z','2','\0','\0'},       -1750,   3103},
     {{'Z','3','\0','\0'},        4159,   2126},
     {{'Z','6','\0','\0'},        4266,   2116},
     {{'Z','8','\0','\0'},        1534,   3232},
     {{'Z','A','\0','\0'},        4120,   1950},
     {{'Z','B','2','\0'},         3557,   -536},
     {{'Z','C','4','\0'},         3510,   3322},
     {{'Z','D','7','\0'},        -1451,   -415},
     {{'Z','D','8','\0'},         -806,  -1418},
     {{'Z','D','9','\0'},        -3700,  -1203},
     {{'Z','F','\0','\0'},        1918,  -8123},
     {{'Z','K','3','\0'},         -922, -16951},
     {{'Z','L','\0','\0'},       -4118,  17447},
     {{'Z','L','7','\0'},        -4408, -17635},
     {{'Z','L','8','\0'},        -3059, -17850},
     {{'Z','L','9','\0'},        -5146,  16608},
     {{'Z','P','\0','\0'},       -2400,  -5700},
     {{'Z','S','\0','\0'},       -3100,   2300},
     {{'Z','S','\0','\0'},       -2600,   2900},
     {{'Z','S','8','\0'},        -4649,   3947},
};

#define N_PREFIXES NARRAY(prefixes)
#define MAX_R2   (11*11)          // max radius^2, sqr degrees

/* find nearest prefix, if within allowed max
 */
bool nearestPrefix (const LatLong &ll, char prefix[MAX_PREF_LEN+1])
{
    // cache
    static LatLong prev_ll;
    static char prev_prefix[MAX_PREF_LEN+1];
    static bool prev_return;
    if (memcmp (&ll, &prev_ll, sizeof(ll)) == 0) {
        memcpy (prefix, prev_prefix, MAX_PREF_LEN+1);
        return (prev_return);
    }

    // save query location
    prev_ll = ll;

    // scan for closest location
    float mind2 = 1e10;
    float coslat = cosf(ll.lat);
    uint16_t closest_prefix = 0;
    for (uint16_t i = 0; i < N_PREFIXES; i++) {
        float dlat = ll.lat_d - 0.01F * (int16_t) pgm_read_word (&prefixes[i].lat);
        float dlng = lngDiff(ll.lng_d - 0.01F * (int16_t) pgm_read_word (&prefixes[i].lng));
        dlng *= coslat;
        float d2 = dlat*dlat + dlng*dlng;
        if (d2 < mind2) {
            mind2 = d2;
            closest_prefix = i;
        }
    }

    // fail if too far away
    // Serial.printf ("mind2 = %g\n", mind2);
    if (mind2 > MAX_R2) {
        prev_return = false;
        return (false);
    }

    // float lat = (float) pgm_read_float (&prefixes[closest_prefix].lat),
    // float lng = (float) pgm_read_float (&prefixes[closest_prefix].lng));

    // create legitimate string
    for (uint8_t i = 0; i < MAX_PREF_LEN; i++)
        prefix[i] = (char) pgm_read_byte (&prefixes[closest_prefix].prefix[i]);
    prefix[MAX_PREF_LEN] = '\0';

    // save result
    memcpy (prev_prefix, prefix, MAX_PREF_LEN+1);
    prev_return = true;

    // good
    return (true);
}

